<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Code Display</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 20px;
            padding: 20px;
        }
        pre {
            background-color: #333;
            color: #fff;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <h2>Python Code</h2>
    <pre>
********************************************************************************************************************************************************************
Practical 6

        import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans

# Load data
data = pd.read_csv("/content/mail.csv")

# Correlation matrix
data[['Age', 'Annual Income (k$)', 'Spending Score (1-100)']].corr()

# Distribution plots
features = ['Annual Income (k$)', 'Age', 'Spending Score (1-100)']
for feature in features:
    plt.figure(figsize=(10,6))
    sns.histplot(data[feature], kde=True)
    plt.title(f'Distribution of {feature}')
    plt.xlabel(feature)
    plt.ylabel('Count')
    plt.show()

# Gender distribution
plt.figure(figsize=(10,4))
sns.countplot(x=data['Gender'])
plt.title("Gender Distribution")
plt.show()

# Scatter plots
sns.pairplot(data, hue='Gender', vars=['Age', 'Annual Income (k$)', 'Spending Score (1-100)'])
plt.show()

# Spending Score Groups
bins = [1, 20, 40, 60, 80, 100]
labels = ["1-20", "21-40", "41-60", "61-80", "81-100"]
data['Spending Group'] = pd.cut(data['Spending Score (1-100)'], bins=bins, labels=labels)
sns.countplot(x='Spending Group', data=data, palette="Set2")
plt.title("Spending Scores Distribution")
plt.show()

# Annual Income Groups
bins_income = [0, 30, 60, 90, 120, 150]
labels_income = ["0-30k", "30k-60k", "60k-90k", "90k-120k", "120k-150k"]
data['Income Group'] = pd.cut(data['Annual Income (k$)'], bins=bins_income, labels=labels_income)
sns.countplot(x='Income Group', data=data, palette="nipy_spectral")
plt.title("Annual Income Distribution")
plt.show()

# K-Means Clustering
X = data[['Annual Income (k$)', 'Spending Score (1-100)']]

# Finding optimal K using Elbow Method
wcss = [KMeans(n_clusters=i, random_state=42).fit(X).inertia_ for i in range(1, 11)]
plt.plot(range(1, 11), wcss, 'ro-', linewidth=2)
plt.xlabel("Number of Clusters (K)")
plt.ylabel("WCSS")
plt.title("Elbow Method for Optimal K")
plt.show()

# Apply K-Means with K=5
kmeans = KMeans(n_clusters=5, random_state=42)
data['Cluster'] = kmeans.fit_predict(X)

# Scatter plot of clusters
sns.scatterplot(x='Annual Income (k$)', y='Spending Score (1-100)', hue=data['Cluster'], palette='Set1', data=data)
plt.title("Customer Segments")
plt.show()

# Display number of customers in each cluster
data.groupby('Cluster')['CustomerID'].count().rename("Count")

    </pre>
</body>
</html>
