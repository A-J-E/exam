<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Code Display</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 20px;
            padding: 20px;
        }
        pre {
            background-color: #333;
            color: #fff;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <h2>Python Code</h2>
    <pre>
********************************************************************************************************************************************************************
Practical 6

# Commented out IPython magic to ensure Python compatibility.
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
# %matplotlib inline

import pandas as pd
data = pd.read_csv("/content/mail.csv")

data.head()

data[['Age', 'Annual Income (k$)', 'Spending Score (1-100)']].corr()

plt.figure(figsize=(10,6))
sns.set(style='whitegrid')
sns.distplot(data['Annual Income (k$)'])
plt.title('Distribution of Annual Income (k$) :- 9130 ',fontsize=20)
plt.xlabel('Range Annual Income (k$)')
plt.ylabel('count')

plt.figure(figsize=(10,6))
sns.set(style='whitegrid')
sns.displot(data['Age'])
plt.title('Distribution of Age :- 9130 ',fontsize=20)
plt.xlabel('Range Age')
plt.ylabel('count')

plt.figure(figsize=(10,6))
sns.set(style='whitegrid')
sns.distplot(data['Spending Score (1-100)'])
plt.title('Distribution of Spending Score (1-100) :- 9130 ',fontsize=20)
plt.xlabel('Range Spending Score (1-100)')
plt.ylabel('count')

gender = data.Gender.value_counts()
sns.set_style("darkgrid")
plt.figure(figsize=(10,4))
sns.barplot(x=gender.index, y=gender.values)
plt.show()

plt.figure(figsize=(10,6))
sns.scatterplot(x='Age',y='Annual Income (k$)' , hue='Gender',data=data , s=60)
plt.xlabel('Age'),plt.ylabel('Annual Income (k$)')
plt.title('age va Annual Income w.r.t Gender')
plt.legend()
plt.show()

plt.figure(figsize=(10,6))
sns.scatterplot(x='Annual Income (k$)', y='Spending Score (1-100)', hue='Gender', data=data, s=60)
plt.xlabel('Annual Income (k$)'), plt.ylabel('Spending Score (1-100)')
plt.title('Spending Score (1-100) vs Annual income (k$)')
plt.legend()
plt.show()

ss1_20 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] > 1) & (data["Spending Score (1-100)"] < 20)]
ss21_40 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] >= 21) & (data["Spending Score (1-100)"] < 40)]
ss41_60 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] >= 41) & (data["Spending Score (1-100)"] < 60)]
ss61_80 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] >= 61) & (data["Spending Score (1-100)"] < 80)]
ss81_100 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] >= 81) & (data["Spending Score (1-100)"] <= 100)]

score_x = ["1-20", "21-40", "41-60", "61-80", "81-100"]
score_y = [len(ss1_20.values), len(ss21_40.values), len(ss41_60.values), len(ss61_80.values), len(ss81_100.values)]

plt.figure(figsize=(10, 6))
sns.barplot(x=score_x, y=score_y, palette="Set2")
plt.title("Spending Scores 9130")
plt.xlabel("Score")
plt.ylabel("Number of Customer Having the Spending Score in that Range")
plt.show()

ss1_20 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] <= 20)]
ss21_40 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] > 21) & (data["Spending Score (1-100)"] <= 40)]
ss41_60 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] > 41) & (data["Spending Score (1-100)"] <= 60)]
ss61_80 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] > 61) & (data["Spending Score (1-100)"] <= 80)]
ss81_100 = data["Spending Score (1-100)"][(data["Spending Score (1-100)"] > 81) & (data["Spending Score (1-100)"] <= 100)]
score = ["1-20", "21-40", "41-60", "61-80", "81-100"]
score_y = [len(ss1_20.values), len(ss21_40.values), len(ss41_60.values), len(ss61_80.values), len(ss81_100.values)]
plt.figure(figsize=(10, 6))
sns.barplot(x=score, y=score_y, palette="Set2")
plt.title("Spending Scores")
plt.xlabel("Score")
plt.ylabel("Number of Customer Having the Spending Score In That Range")
plt.show()

a10_30 = data["Annual Income (k$)"] [(data["Annual Income (k$)"] >= 0) & (data["Annual Income (k$)"] < 30)]
a131_60 = data["Annual Income (k$)"] [(data["Annual Income (k$)"] >= 31) & (data["Annual Income (k$)"] < 60)]
a161_90 = data["Annual Income (k$)"] [(data["Annual Income (k$)"] >= 61) & (data["Annual Income (k$)"] < 90)]
a191_120 = data["Annual Income (k$)"] [(data["Annual Income (k$)"] >= 91) & (data["Annual Income (k$)"] < 120)]
a121_150 = data["Annual Income (k$)"] [(data["Annual Income (k$)"] >= 121) & (data["Annual Income (k$)"] < 150)]

income_x = ["$ 0 - 30,000", "$ 30,001 - 50,000", "$ 50,001 - 90,000", "$ 90,001 - 120,000", "$ 120,001 - 150,000"]
income_y = [len(a10_30.values), len(a131_60.values), len(a161_90.values), len(a191_120.values), len(a121_150.values)]

plt.figure(figsize=(15, 6))
sns.barplot(x=income_x, y=income_y, palette="nipy_spectral")
plt.title("Annual Incomes")
plt.xlabel("Income")
plt.ylabel("Number of Customers")
plt.show()

data

df1 = data[["CustomerID", "Gender", "Age", "Annual Income (k$)", "Spending Score (1-100)"]]  # Corrected column names
x = df1[["Annual Income (k$)", "Spending Score (1-100)"]]

x.head()

plt.figure(figsize=(10,6))
sns.scatterplot(x='Annual Income (k$)', y='Spending Score (1-100)', data= x ,s=60)
plt.xlabel('Annual Income (k$)'), plt.ylabel('Spending Score (1-100)')
plt.title('Spending Score (1-100) vs Annual income (k$)')
plt.show()

from sklearn.cluster import KMeans

wcss = []
for i in range(1,11):
  km = KMeans(n_clusters=1)
  km.fit(x)
  wcss.append(km.inertia_)

plt.figure(figsize =(12,6))
plt.plot(range(1,11),wcss)
plt.plot(range(1,11),wcss, linewidth = 2, color = "red", marker ="8")
plt.xlabel("K Value")
plt.xticks(np.arange(1,11,1))
plt.ylabel("WCSS")
plt.show()

km1=KMeans(n_clusters=5)
km1.fit(x)
y=km1.predict(x)

df1['label'] = y
df1.head()

plt.figure(figsize=(10,6))
sns.scatterplot(x='Annual Income (k$)', y='Spending Score (1-100)', hue='label',
                palette=['green','orange','brown','dodgerblue','red'],data=df1, s=60)
plt.xlabel('Annual Income (k$)'), plt.ylabel('Spending Score (1-100)')
plt.xlabel('Annual Income (k$)'), plt.ylabel('Spending Score (1-100)')
plt.title('Spending Score (1-100) vs Annual income (k$)')
plt.show()

cust0=df1[df1["label"]==0]
print('Number of customer in 0th group=', len(cust0))
print('They are -', cust0["CustomerID"].values)
print("--------------------------------------------------")
cust1=df1[df1["label"]==1]
print('Number of customer in 1st group=', len(cust1))
print('They are -', cust1["CustomerID"].values)
print("--------------------------------------------------")
cust2=df1[df1["label"]==2]
print('Number of customer in 2nd group=', len(cust2))
print('They are -', cust2["CustomerID"].values)
print("--------------------------------------------------")
cust3=df1[df1["label"]==3]
print('Number of customer in 3rd group=', len(cust3))
print('They are -', cust3["CustomerID"].values)
print("--------------------------------------------------")
cust4=df1[df1["label"]==4]
print('Number of customer in 4th group=', len(cust4))
print('They are -', cust4["CustomerID"].values)

____________________________________________________________________________________________________________________________________________________________________
practical 8
        
!pip install apyori

import pandas as pd
import numpy as np
from apyori import apriori
path = '/content/Market_Basket_Optimisation.csv'
df=pd.read_csv(path)
df.fillna(0,inplace=True)
df.head()

transactions=[]
for i in range(0,len(df)):
  transactions.append([str(df.values[i,j])for j in range(0,20) if str(df.values[i,j])!='0'])

transactions[0]

transactions[1]

rules=apriori(transactions,min_support=0.003,min_confidence=0.2,min_lift=3,min_length=2)
rules

Results=list(rules)
Results

df_results=pd.DataFrame(Results)
df_results.head()

support=df_results.support

first_values=[]
second_values=[]
third_values=[]
fourth_values=[]

for i in range(df_results.shape[0]):
  single_list=df_results['ordered_statistics'][i][0]
  first_values.append(list(single_list[0]))
  second_values.append(list(single_list[1]))
  third_values.append(single_list[2])
  fourth_values.append(single_list[3])

lhs=pd.DataFrame(first_values)
rhs=pd.DataFrame(second_values)
confidence=pd.DataFrame(third_values,columns=['Confidence'])
lift=pd.DataFrame(fourth_values,columns=['lift'])

df_final=pd.concat([lhs,rhs,support,confidence,lift],axis=1)
df_final

df_final.fillna(value=' ',inplace=True)
df_final.head()

df_final.columns=['lhs',1,'rhs',2,3,4,'support','confidence','lift']
df_final.head()

df_final['lhs']=df_final['lhs']+str(", ")+df_final[1]
df_final['rhs']=df_final['rhs']+str(", ")+df_final[2]+str(", ")+df_final[3]
df_final.head()

df_final.drop(columns=[1,2,3,4],inplace=True)
df_final.head()

df_final.sort_values('lift',ascending=False).head(10)


____________________________________________________________________________________________________________________________________________________________________
practical 9

# Commented out IPython magic to ensure Python compatibility.
import warnings
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import pearsonr
from sklearn.naive_bayes import GaussianNB
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, recall_score, precision_score
# %matplotlib inline
warnings.filterwarnings("ignore")
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split

def cross_validate(estimator,train,validation):
  X_train=train[0]
  Y_train=train[1]
  X_val=validation[0]
  Y_val=validation[1]
  train_predictions=classifier.predict(X_train)
  train_accuracy=accuracy_score(Y_train,train_predictions)
  train_recall=recall_score(Y_train,train_predictions)
  train_precision=precision_score(Y_train,train_predictions)
  val_predictions=classifier.predict(X_val)
  val_accuracy=accuracy_score(Y_val,val_predictions)
  val_recall=recall_score(Y_val,val_predictions)
  val_precision=precision_score(Y_val,val_predictions)

  print('Model metrics')
  print('Accuracy Train: %.2f, Validation: %.2f' %(train_accuracy,val_accuracy))
  print('Recall Train: %.2f, Validation: %.2f' % (train_recall,val_recall))
  print('Precision Train: %.2f, Validation: %.2f' % (train_precision,val_precision))

test_raw=pd.read_csv('/content/test.csv')
train_raw=pd.read_csv('/content/train (1).csv')

test_ids=test_raw['PassengerId'].values
train_raw['train']=1
test_raw['train']=0
data = pd.concat([test_raw, train_raw], sort=False)
data.head()

data.describe()

features=['Age','Embarked','Fare','Parch','Pclass','Sex','SibSp']
target='Survived'
data=data[features+[target]+['train']]
data['Sex']=data['Sex'].replace(["female","male"],[0,1])
data['Embarked']=data['Embarked'].replace(['S','C','Q'],[1,2,3])
data['Age']=pd.qcut(data['Age'],10,labels=False)

train=data.query('train==1')
test=data.query('train==0')
train.dropna(axis=0,inplace=True)
labels=train[target].values
train.head()

columns=train[features+[target]].columns.tolist()
nColumns=len(columns)
result=pd.DataFrame(np.zeros((nColumns,nColumns)),columns=columns)

for col_a in range(nColumns):
  for col_b in range(nColumns):
    result.iloc[[col_a,col_b]]=pearsonr(train.loc[:,columns[col_a]],train.loc[:,columns[col_b]])[0]

fig,ax=plt.subplots(figsize=(10,10))
ax=sns.heatmap(result,yticklabels=columns,vmin=1,vmax=1,annot=True,fmt='.2f',linewidths=.2)
ax.set_title('Pearson Correlation')
plt.show()

continuous_numeric_features=['Age','Fare','Parch','SibSp']
for feature in continuous_numeric_features:
  sns.distplot(train[features])
  plt.show()

train.drop(['train',target,'Pclass'],axis=1,inplace=True)
test.drop(['train',target,'Pclass'],axis=1,inplace=True)
X_train,X_val,Y_train,Y_val=train_test_split(train,labels,test_size=0.2,random_state=29)
X_train.head()

X_train1,X_train2,Y_train1,Y_train2=train_test_split(train,labels,test_size=0.3,random_state=29)
classifier=GaussianNB()
classifier.fit(X_train2,Y_train2)
print('Metrics with only 30% of train data')
cross_validate(classifier,(X_train,Y_train),(X_val,Y_val))

classifier.partial_fit(X_train1,Y_train1)
print('Metrics with 70% of train data')
cross_validate(classifier,(X_train,Y_train),(X_val,Y_val))

print('Probability of each class')
print('Survive = 0: %.2f' % classifier.class_prior_[0])
print('Survive = 1: %.2f' % classifier.class_prior_[1])

print('Mean of each feature per class')
print('                 Age       Embarked      Fare        Parch       Sex       SibSp')
print('Survive = 0: %s' % classifier.theta_[0])
print('Survive = 1: %s' % classifier.theta_[1])

print('Variance of each feature per class')
print('Survive = 0: %s' % classifier.var_[0])
print('Survive = 1: %s' % classifier.var_[1])

test.fillna(test.mean(),inplace=True)
test_predictions=classifier.predict(test)
submission=pd.DataFrame({'PassengerId': test_ids})
submission['Survived']=test_predictions.astype('int')
submission.to_csv('submission.csv',index=False)
submission.head(10)

    </pre>
</body>
</html>
